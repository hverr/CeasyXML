<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>Parsing XML documents Document</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<meta name="viewport" content="width=550" />
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />	
		<meta name="generator" content="appledoc 2.0.5 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">CeasyXML </a></h1>
				<a id="developerHome" href="../index.html">Henri Verroken</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode" id="pageTitleHeader">Parsing XML documents Document</h1>
			</div>
			<ul id="headerButtons" role="toolbar"></ul>
		</header>
		<article>
			<a title="Parsing XML documents Document" name="top"></a>
			<div id="overview_contents" role="main">
				<div id="container">	
					<h1>Parsing XML documents</h1>

<p>In this document we explain how to use CeasyXML to parse an XML document. We
will explain which classes to use and how to use them.</p>

<h2>Defining the Layout</h2>

<p>We define the layout of our XML document as explained in <a href="How%20to%20define%20the%20layout%20of%20your%20XML%20document.html">How to define the
layout of your XML document</a>.</p>

<pre><code>&lt;!-- Layout.xml --&gt;
&lt;?xml version="1.0" encoding="utf-8" ?&gt;

&lt;document&gt;
    &lt;layout name="library" class="TLibrary"&gt;
        &lt;!-- library: elements --&gt;
        &lt;element name="name"&gt;
            &lt;unique /&gt;
            &lt;required /&gt;
            &lt;content type="string"&gt;
                &lt;getter&gt;name&lt;/getter&gt;
                &lt;setter&gt;setName:&lt;/setter&gt;
            &lt;/content&gt;
        &lt;/element&gt;

        &lt;element name="content"&gt;
            &lt;unique /&gt;
            &lt;content type="string"&gt;
                &lt;getter&gt;content&lt;/getter&gt;
                &lt;setter&gt;setContent:&lt;/setter&gt;
            &lt;/content&gt;
        &lt;/element&gt;

        &lt;element name="entry"&gt;
            &lt;!-- entry: content --&gt;
            &lt;content type="custom"&gt;
                &lt;getter&gt;entries&lt;/getter&gt;
                &lt;setter&gt;setEntries:&lt;/setter&gt;
                &lt;class&gt;TEntry&lt;/class&gt;
            &lt;/content&gt;

            &lt;!-- entry: attributes --&gt;
            &lt;attribute name="type"&gt;
                &lt;required /&gt;
                &lt;content type="string"&gt;
                    &lt;getter&gt;type&lt;/getter&gt;
                    &lt;setter&gt;setType:&lt;/setter&gt;
                &lt;/content&gt;
            &lt;/attribute&gt;&lt;!-- type --&gt;

            &lt;!-- entry: elements --&gt;
            &lt;element name="title"&gt;
                &lt;required /&gt;
                &lt;unique /&gt;
                &lt;content type="string"&gt;
                    &lt;getter&gt;title&lt;/getter&gt;
                    &lt;setter&gt;setTitle:&lt;/setter&gt;
                &lt;/content&gt;
            &lt;/element&gt;&lt;!-- title --&gt;

            &lt;element name="creator"&gt;
                &lt;required /&gt;
                &lt;unique /&gt;
                &lt;content type="string"&gt;
                    &lt;getter&gt;creator&lt;/getter&gt;
                    &lt;setter&gt;setCreator:&lt;/setter&gt;
                &lt;/content&gt;
            &lt;/element&gt;&lt;!-- creator --&gt;

            &lt;element name="year"&gt;
                &lt;required /&gt;
                &lt;unique /&gt;
                &lt;content type="number"&gt;
                    &lt;getter&gt;year&lt;/getter&gt;
                    &lt;setter&gt;setYear:&lt;/setter&gt;
                &lt;/content&gt;
            &lt;/element&gt;&lt;!-- year --&gt;

        &lt;/element&gt;&lt;!-- entry --&gt;
    &lt;/layout&gt;&lt;!-- library --&gt;
&lt;/document&gt;
</code></pre>

<h2>Our XML Document</h2>

<p>We also have a document that uses the layout.</p>

<pre><code>&lt;!-- Library.xml --&gt;
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;library&gt;
    &lt;name&gt;The CeasyXML Test Library&lt;/name&gt;
    &lt;content&gt;Some entries for testing.&lt;/content&gt;

    &lt;entry type="book"&gt;
        &lt;title&gt;Of Mice and Men&lt;/title&gt;
        &lt;creator&gt;John Steinbeck&lt;/creator&gt;
        &lt;year&gt;1937&lt;/year&gt;
    &lt;/entry&gt;

    &lt;entry type="book"&gt;
        &lt;title&gt;Sopie's World&lt;/title&gt;
        &lt;creator&gt;Jostein Gaarder&lt;/creator&gt;
        &lt;year&gt;1991&lt;/year&gt;
    &lt;/entry&gt;

    &lt;entry type="movie"&gt;
        &lt;title&gt;The Truman Show&lt;/title&gt;
        &lt;creator&gt;Peter Weir&lt;/creator&gt;
        &lt;year&gt;1998&lt;/year&gt;
    &lt;/entry&gt;
&lt;/library&gt;
</code></pre>

<h2>Custom Classes</h2>

<p>Finally we have the classes to use when parsing the document.</p>

<ul>
<li><p>TEntry</p>

<ul>
<li>property type (NSString)</li>
<li>property title (NSString)</li>
<li>property creator (NSString)</li>
<li>property year (NSInteger)</li>
</ul>
</li>
<li><p>TLibrary</p>

<ul>
<li>property name (NSString)</li>
<li>property content (NSString)</li>
<li>property entries (NSMutableArray)</li>
</ul>
</li>
</ul>


<p>Note that the initialization method should not set any of these instance
variables, as they will be overwritten when parsing the XML document with
<a href="../Classes/CSXXMLParser.html"><code>CSXXMLParser</code></a>.</p>

<h2>Parsing the XML Document</h2>

<p>Now we are going to use <a href="../Classes/CSXXMLParser.html"><code>CSXXMLParser</code></a> to parse our XML document. We firstly
create our XML parser with the layout document. Then we give it the document to
parse. Finally we query the result.</p>

<pre><code>CSXXMLParser *parser;
NSString *layoutFile;
NSString *xmlFile;
BOOL success;
NSError *error;

// We use the two documents defined above
layoutFile = @"Layout.xml";
xmlFile = @"Library.xml";

// Now we create the XML parser with the layout document
// Notice that we use -initWithLayoutListDocument:error: and not
// -initWithLayoutDocument:error: since our layout document has the
// root element 'document' and not 'layout'.
parser = [[CSXXMLParser alloc] initWithLayoutListDocument:layoutFile
                                                    error:&amp;error];
if(parser == nil) {
    // An error occurred while parsing the layout document
    NSLog(@"Failed to parse the layout document: %@", error);
    return;
}

// Parse the file we want to parse
parser.file = xmlFile;

// Parse the file
success = [parser parse];

// Check for errors or print the return value
if(success == NO) {
    NSLog(@"Failed to parse the XML document: %@", parser.error);
    [parser release];
    return;
}

if([parser.warnings count]) {
    NSLog(@"Warnings while parsing the XML document:\n%@", 
          parser.warnings);
}

NSLog(@"Library %@ with %d entries.", parser.result, 
      ((TLibrary *)parser.result entries] count]);

[parser release];
</code></pre>

<p>The <code>TLibrary</code> instance is held in <code>parser.result</code> after parsing the XML
document.</p>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2012 Henri Verroken. All rights reserved. (Last updated: 2012-07-12)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.5 (build 789)</a>.</span></p>
						
					
					</div>
				</div>
			</div>
		</article>
	</body>
</html>